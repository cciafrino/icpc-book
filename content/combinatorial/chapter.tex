\newcommand*{\Comb}[2]{{}^{#1}C_{#2}}%
\newcommand{\stirlingfirst}[2]{\genfrac{[}{]}{0pt}{}{#1}{#2}}
\newcommand{\stirlingsecond}[2]{\genfrac{\{}{\}}{0pt}{}{#1}{#2}}

\chapter{Combinatorial}

\section{Permutations}
	\subsection{Factorial}
		\import{factorial.tex} 
		\kactlimport{Factorial.h}
		\kactlimport{numPerm.h}

\subsection{Binomials}
	\kactlimport{PascalTriangle.h}

	\begin{itemize}
	\item Sum of every element in the $n$-th row of pascal triangle is $2^n$.
	\item The product of the elements in each row is $\frac{(n + 1)^n}{n!}$
	\item $\sum_{k = 0}^{n} \binom{n}{k}^2 = \binom{2n}{n}$
	\item In a row $p$ where $p$ is a prime number, all the terms in that row except the 1s are multiples of $p$
	\item To count odd terms in row $n$, convert $n$ to binary. Let $x$ be the number of 1s in the binary representation. Then the number of odd terms will be $2^x$
	\item Every entry in row $2^n - 1$ is odd
	\end{itemize}

	\kactlimport{nCr.h}
	\kactlimport{RollingBinomial.h}
	\kactlimport{Lucas.h}
	\kactlimport{Multinomial.h}



\subsection{Involutions}
    An involution is a permutation with maximum cycle length 2, and it is its own inverse. 
    $$a(n) = a(n-1) + (n-1)a(n-2)$$
    $$a(0) = a(1) = 1$$
    1, 1, 2, 4, 10, 26, 76, 232, 764, 2620, 9496, 35696, 140152\\

\subsection{Cycles}
		Let the number of $n$-permutations whose cycle lenghts all belong to the set $S$ be denoted by $g_S (n)$
		\small
		$$\sum_{n=0} ^\infty g_S(n) \frac{x^n}{n!} = \exp\left(\sum_{n\in S} \frac{x^n}{n} \right)$$
		\normalsize

\subsection{Inclusion-Exclusion Principle}
	Let $A_1, A_2, ..., A_n$ be finite sets. Then  $A_1 \cup A_2 \cup ... \cup A_n$ is
	\[ \left| \bigcup^n_{i = 1} A_i \right|  = \sum_{\substack{I \subseteq \{1, 2, ..., n\}\\ I \neq \emptyset}}^{} (-1)^{\left| I \right| +1} \left| \bigcap\limits_{i\in I} A_i \right| \]

\subsection{The twelvefold way (from Stanley)} How many functions $f \colon N \rightarrow X$ are there?

\resizebox{\columnwidth}{!}{%
  \begin{tabular}{|c|c|c|c|c|}
    \hline
    $N$ & $X$ & Any $f$ & Injective & Surjective \\ \hline
    dist. & dist. & $x^n$ & $\frac{x!}{(x-n)!}$ & $x! \stirlingsecond{n}{x}$ \\ \hline
    indist. & dist. & $\binom{x+n-1}{n}$ & $\binom{x}{n}$ & $\binom{n-1}{n-x}$ \\ \hline
    dist. & indist. & $\stirlingsecond{n}{1} + \ldots + \stirlingsecond{n}{x}$ & $[n \leq x]$ & $\stirlingsecond{n}{k}$ \\ \hline
    indist. & indist. & $p_1(n) + \ldots p_x(n)$ & $[n \leq x]$ & $p_x(n)$ \\ \hline
  \end{tabular}
}

  Where $\binom{a}{b} = \frac{1}{b!}(a)_b $, $p_x(n)$ is the number of ways to partition the integer $n$ using $x$ summand and $\stirlingsecond{n}{x}$ is the number of ways to partition a set of $n$ elements into $x$ subsets (aka Stirling number of the second kind).
	
\subsection{Burnside}
Given a group $G$ of symmetries and a set $X$, the number of elements of $X$ \emph{up to symmetry} equals
		 \[ {\frac {1}{|G|}}\sum _{{g\in G}}|X^{g}|, \]
		 where $X^{g}$ are the elements fixed by $g$ ($g.x = x$).

 If $f(n)$ counts ``configurations'' (of some sort) of length $n$, we can ignore rotational symmetry using $G = \mathbb Z_n$ to get
		 \[ g(n) = \frac 1 n \sum_{k=0}^{n-1}{f(\text{gcd}(n, k))} = \frac 1 n \sum_{k|n}{f(k)\phi(n/k)}. \]

\subsection{Derangements}

Permutations of a set such that none of the elements appear in their original position.
\small
\[ \mkern-2mu D(n) = (n-1)(D(n-1)+D(n-2)) = n D(n-1)+(-1)^n = \left\lfloor\frac{n!}{e}\right\rceil \]
\normalsize


\section{Partitions and subsets}

\subsection{Partition function}
	Number of ways of writing $n$ as a sum of positive integers, disregarding the order of the summands.
	\small
	\[ p(0) = 1,\ p(n) = \sum_{k \in \mathbb Z \setminus \{0\}}{(-1)^{k+1} p(n - k(3k-1) / 2)} \]
	\[ p(n) \sim 0.145 / n \cdot \exp(2.56 \sqrt{n}) \]

	\begin{center}
	\begin{tabular}{c|c@{\ }c@{\ }c@{\ }c@{\ }c@{\ }c@{\ }c@{\ }c@{\ }c@{\ }c@{\ }c@{\ }c@{\ }c}
		$n$    & 0 & 1 & 2 & 3 & 4 & 5 & 6  & 7  & 8  & 9  & 20  & 50  & 100 \\ \hline
		$p(n)$ & 1 & 1 & 2 & 3 & 5 & 7 & 11 & 15 & 22 & 30 & 627 & $\mathtt{\sim}$2e5 & $\mathtt{\sim}$2e8 \\
	\end{tabular}
	\end{center}
	\normalsize

\section{General purpose numbers}

\subsection{Bernoulli numbers}
	EGF of Bernoulli numbers is $B(t)=\frac{t}{e^t-1}$ (FFT-able).
	$B[0,\ldots] = [1, -\frac{1}{2}, \frac{1}{6}, 0, -\frac{1}{30}, 0, \frac{1}{42}, \ldots]$

	Sums of powers:
	\small
	\[ \sum_{i=1}^n n^m = \frac{1}{m+1} \sum_{k=0}^m \binom{m+1}{k} B_k (n+1)^{m+1-k} \]
	\normalsize
	Euler-Maclaurin formula for infinite sums:
	\small
	\[ \sum_{i=m}^{\infty} f(i) = \int_m^\infty f(x) dx - \sum_{k=1}^\infty \frac{B_k}{k!}f^{(k-1)}(m) \]
	\[ \approx \int_{m}^\infty f(x)dx + \frac{f(m)}{2} - \frac{f'(m)}{12} + \frac{f'''(m)}{720} + O(f^{(5)}(m)) \]
	\normalsize

\subsection{Stirling numbers of the first kind}
	Number of permutations on $n$ items with $k$ cycles.
	\begin{align*}
		&c(n,k) = c(n-1,k-1) + (n-1) c(n-1,k), c(0,0) = 1\\
		&\textstyle \sum_{k=0}^n c(n,k)x^k = x(x+1) \dots (x+n-1)
	\end{align*}
	$c(8,k) = 8, 0, 5040, 13068, 13132, 6769, 1960, 322, 28, 1$ 
	$c(n,2) = 0, 0, 1, 3, 11, 50, 274, 1764, 13068, 109584, \dots$

\subsection{Eulerian numbers}
	Number of permutations $\pi \in S_n$ in which exactly $k$ elements are greater than the previous element. $k$ $j$:s s.t. $\pi(j)>\pi(j+1)$, $k+1$ $j$:s s.t. $\pi(j)\geq j$, $k$ $j$:s s.t. $\pi(j)>j$.
	$$E(n,k) = (n-k)E(n-1,k-1) + (k+1)E(n-1,k)$$
	$$E(n,0) = E(n,n-1) = 1$$
	$$E(n,k) = \sum_{j=0}^k(-1)^j\binom{n+1}{j}(k+1-j)^n$$

\subsection{Stirling numbers of the second kind}
	Partitions of $n$ distinct elements into exactly $k$ groups.
	$$S(n,k) = S(n-1,k-1) + k S(n-1,k)$$
	$$S(n,1) = S(n,n) = 1$$
	$$S(n,k) = \frac{1}{k!}\sum_{j=0}^k (-1)^{k-j}\binom{k}{j}j^n$$

\subsection{Bell numbers}
	Total number of partitions of $n$ distinct elements. $B(n) =$
	$1, 1, 2, 5, 15, 52, 203, 877, 4140, 21147, \dots$. 
	\begin{equation*}
    \mathcal{B}_{n+1} = \sum_{k=0}^n \binom{n}{k} \mathcal{B}_k
  \end{equation*}
  Also possible to calculate using Stirling numbers of the second kind,
  \[B_n = \sum_{k = 0}^{n} S(n, k)\]
  If $p$ is prime:
	\[ B(p^m+n)\equiv mB(n)+B(n+1) \pmod{p} \]

\subsection{Labeled unrooted trees}
	\# on $n$ vertices: $n^{n-2}$ \\
	\# on $k$ existing trees of size $n_i$: $n_1n_2\cdots n_k n^{k-2}$\\
	\# with degrees $d_i$: $(n-2)! / ((d_1-1)! \cdots (d_n-1)!)$
	\# forests with exactly $k$ rooted trees: $$\binom{n}{k} k \cdot n^{n-k-1}$$.

\subsection{Catalan numbers}
	\[ C_n=\frac{1}{n+1}\binom{2n}{n}= \binom{2n}{n}-\binom{2n}{n+1} = \frac{(2n)!}{(n+1)!n!} \]
	\[ C_0=1,\ C_{n+1} = \frac{2(2n+1)}{n+2}C_n,\ C_{n+1}=\sum C_iC_{n-i} \]
	${C_n = 1, 1, 2, 5, 14, 42, 132, 429, 1430, 4862, 16796, 58786, \dots}$
	\begin{itemize}[noitemsep]
		\item sub-diagonal monotone paths in a $n\times n$ grid.
		\item strings with $n$ pairs of parenthesis, correctly nested.
		\item binary trees with with $n+1$ leaves (0 or 2 children) or $2n + 1$ elements.
		\item ordered trees with $n+1$ vertices.
		\item \# ways a convex polygon with $n+2$ sides can be cut into triangles by connecting vertices with straight lines.
		\item permutations of $[n]$ with no 3-term increasing subsequence.
	\end{itemize}

\subsection{Super Catalan numbers}
The number of monotonic lattice paths of a $n$x$n$ grid that do not touch the diagonal.\\
$$S(n) = \frac{3(2n-3)S(n-1)-(n-3)S(n-2)}{n}$$
$$S(1) = S(2) = 1$$
1, 1, 3, 11, 45, 197, 903, 4279, 20793, 103049, 518859\\

\subsection{Motzkin numbers}
Number of ways of drawing any number of nonintersecting chords among $n$ points on a circle. Number of lattice paths from (0, 0) to ($n$, 0) never going below the $x$-axis, using only steps NE, E, SE.\\

$$M(n) = \frac{3(n-1)M(n-2)+(2n+1)M(n-1)}{n+2}$$\\
$$M(0) = M(1) = 1$$\\
1, 1, 2, 4, 9, 21, 51, 127, 323, 835, 2188, 5798, 15511, 41835, 113634\newline

\subsection{Narayana numbers}
Number of lattice paths from (0,0) to ($2n$,0) never going below the $x$-axis, using only steps NE and SE, and with $k$ peaks.\\
$$N(n,k) = \frac{1}{n} \binom{n}{k} \binom{n}{k-1}$$
$$N(n,1) = N(n,n) = 1$$
$$\sum_{k=1}^{n} N(n,k) = C_{n}$$
1, 1, 1, 1, 3, 1, 1, 6, 6, 1, 1, 10, 20, 10, 1, 1, 15, 50


\subsection{Schroder numbers}
Number of lattice paths from (0, 0) to ($n$, $n$) using only steps
N,NE,E, never going above the diagonal. Number of lattice
paths from (0, 0) to ($2n$, 0) using only steps NE, SE and
double east EE, never going below the x-axis. Twice the
Super Catalan number, except for the first term.\\
1, 2, 6, 22, 90, 394, 1806, 8558, 41586, 206098\\


\subsection{Triangles}
\text{Given rods of length 1, ..., $n$,}

    \[T(n) = \frac{1}{24}  \left\{
    \begin{array}{ll}
        n(n - 2)(2n - 5) & \text{$n$ even}\\
        (n - 1)(n - 3)(2n - 1) & \text{$n$ odd}\\
    \end{array}
\right.\}\]
is the number of distinct triangles (positive are) that can be constructed, i.e., the \# of 3-subsets of [$n$] s.t. $x \leq y \leq z$ and $z \neq x + y$.\\


\section{Fibonacci}
\newcommand{\Fib}{\mathit{Fib}}
\[\Fib(x + y) = \Fib(x + 1) \Fib(y) + \Fib(x) \Fib(y - 1)\]
\[\Fib(n+1)\Fib(n-1) - \Fib(n)^2 = (-1)^n\]
\[\Fib(2n-1) = \Fib(n)^2 - \Fib(n-1)^2\]
$$ \sum_{i=0}^{n} \Fib(i) = \Fib(n+2) - 1$$
$$ \sum_{i=0}^{n} \Fib(i)^2 = \Fib(n)\Fib(n+1)$$
$$ \sum_{i=0}^{n} \Fib(i)^3 = \frac{\Fib(n)\Fib(n+1)^2 - (-1)^n\Fib(n-1) + 1}{2}$$


\section{Game Theory}
A game can be reduced to Nim if it is a finite impartial game.
Nim and its variants include:

\subsection{Nim}
	Let $X = \bigoplus_{i=1}^n x_i$, then $(x_i)_{i=1}^n$ is a winning position iff $X\neq 0$. Find a move by picking $k$ such that $x_k > x_k \oplus X$.
	
\subsection{Mis\`{e}re Nim} 
    Regular Nim, except that the last player to move \textit{loses}. Play regular Nim until there is only one pile of size larger than $1$, reduce it to $0$ or $1$ such that there is an odd number of piles. The second player wins $(a_1, \dots, a_n)$ if 1) there is a pile $a_i > 1$ and $\oplus_{i=1}^{n} a_i = 0$ or 2) all $a_i \leq 1$ and $\oplus_{i=1}^{n} a_i = 1$.

\subsection{Staircase Nim}
Stones are moved down a staircase and only removed from the last pile. $(x_i)_{i=1}^n$ is an $L$-position if $(x_{2i-1})_{i=1}^{n/2}$ is (i.e. only look at odd-numbered piles).

\subsection{Moore's Nim$_k$}
The player may remove from at most $k$ piles (Nim $=$ Nim$_1$). Expand the piles in base $2$, do a carry-less addition in base $k+1$ (i.e. the number of ones in each column should be divisible by $k+1$).

\subsection{Dim$^+$}
The number of removed stones must be a divisor of the pile size. The Sprague-Grundy function is $k+1$ where $2^k$ is the largest power of $2$ dividing the pile size.

\subsection{Aliquot Game}
Same as above, except the divisor should be proper (hence $1$ is also a terminal state, but watch out for size $0$ piles). Now the Sprague-Grundy function is just $k$.

\subsection{Nim (at most half)}
Write $n+1 = 2^my$ with $m$ maximal, then the Sprague-Grundy function of $n$ is $(y - 1) / 2$.

\subsection{Lasker's Nim}
Players may alternatively split a pile into two new non-empty piles. $g(4k+1) = 4k+1$, $g(4k+2) = 4k+2$, $g(4k+3) = 4k+4$, $g(4k+4) = 4k+3$ ($k\geq 0$).

\subsection{Hackenbush on Trees}
A tree with stalks $(x_i)_{i=1}^n$ may be replaced with a single stalk with length $\bigoplus_{i=1}^n x_i$.


\


%\kactlimport{Grundy.h}
%\kactlimport{Nim.cpp}
\kactlimport{Nim-Product.cpp}
%\kactlimport{Schreier-Sims.cpp}
%\kactlimport{RandomWalk.h}
\kactlimport{Partitions.cpp}
	

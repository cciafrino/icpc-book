\newcommand*{\Comb}[2]{{}^{#1}C_{#2}}%

\chapter{Combinatorial}

\section{Permutations}
	\subsection{Factorial}
		\import{factorial.tex}
		\kactlimport{Factorial.h}
		%\kactlimport{IntPerm.h}


\subsection{Cycles}
		Suponha que $g_S(n)$ é o número de $n$-permutações quais o tamanho do ciclo pertence ao conjunto $S$. Então
		\small
		$$\sum_{n=0} ^\infty g_S(n) \frac{x^n}{n!} = \exp\left(\sum_{n\in S} \frac{x^n} {n} \right)$$
		\normalsize

\subsection{Derangements}
		Permutações de um conjunto tais que nenhum dos elementos aparecem em sua posição original.
		\small
		\[ \mkern-2mu D(n) = (n-1)(D(n-1)+D(n-2)) = n D(n-1)+(-1)^n = \left\lfloor\frac{n!}{e}\right\rceil \]
		\normalsize
\subsection{The Twelvefold Way}
Putting $n$ balls into $k$ boxes.
$\mathrm{p}(n,k)$ is \# partitions of $n$ in $k$ parts, each $>0$.
$\mathrm{p}_k(n) = \sum_{i=0}^k \mathrm{p}(n,k)$.

\begin{tabular}{@{}c|c|c|c|c|l@{}}
	Balls & same & distinct & same & distinct\\
	Boxes & same & same & distinct & distinct\\
	\hline
	- & $\mathrm{p}_k(n)$ & $\sum_{i=0}^k \stirling{n}{i}$ & $\binom{n+k-1}{k-1}$ & $k^n$ \\ 
	$\mathrm{size}\ge 1$ & $\mathrm{p}(n,k)$ & $\stirling{n}{k}$ & $\binom{n-1}{k-1}$ & $k!\stirling{n}{k}$ \\
	$\mathrm{size}\le 1$ & $[n \le k]$ & $[n \le k]$ & $\binom{k}{n}$ & $n!\binom{k}{n}$ \\
	\bottomrule
\end{tabular}

    \subsection{Involutions}
    Uma involução é uma permutação com ciclo de tamanho máximo 2, e é a sua própria inversa.
    $$a(n) = a(n-1) + (n-1)a(n-2)$$
    $$a(0) = a(1) = 1$$
    1, 1, 2, 4, 10, 26, 76, 232, 764, 2620, 9496, 35696, 140152
    
	
\subsection{Burnside}
Seja~$A \colon GX \rightarrow X$ uma ação. Defina:
\begin{itemize}
\item $w \coloneqq $ número de órbitas em~$X$.
\item $S_x \coloneqq \{g \in G \mid g \cdot x = x \}$
\item $F_g \coloneqq \{x \in X \mid g \cdot x = x \} $
\end{itemize}
Então $ w = \frac{1}{|G|} \sum\limits_{x \in X}{|S_x|} = \frac{1}{|G|} \sum\limits_{g \in G}{|F_g|}. $

\section{Partitions and subsets}
	\subsection{Partition function}
		Número de formas de escrever $n$ como a soma de inteiros positivos, independente da ordem deles.
		\small
		\[ p(0) = 1,\ p(n) = \sum_{k \in \mathbb Z \setminus \{0\}}{(-1)^{k+1} p(n - k(3k-1) / 2)} \]
		\[ p(n) \sim 0.145 / n \cdot \exp(2.56 \sqrt{n}) \]

		\begin{center}
		\begin{tabular}{c|c@{\ }c@{\ }c@{\ }c@{\ }c@{\ }c@{\ }c@{\ }c@{\ }c@{\ }c@{\ }c@{\ }c@{\ }c}
			$n$    & 0 & 1 & 2 & 3 & 4 & 5 & 6  & 7  & 8  & 9  & 20  & 50  & 100 \\ \hline
			$p(n)$ & 1 & 1 & 2 & 3 & 5 & 7 & 11 & 15 & 22 & 30 & 627 & $\mathtt{\sim}$2e5 & $\mathtt{\sim}$2e8 \\
		\end{tabular}
		\end{center}
		\normalsize
    
    
	\subsection{Binomials}
		\kactlimport{nCr.h}
		\kactlimport{NWayDistribute.h}
		\kactlimport{PascalTriangle.h}
		\kactlimport{Multinomial.h}
		\kactlimport{Catalan.h}

\section{General purpose numbers}
	%\subsection{Bernoulli numbers}
	%	EGF of Bernoulli numbers is $B(t)=\frac{t}{e^t-1}$ (FFT-able).
	%	$B[0,\ldots] = [1, -\frac{1}{2}, \frac{1}{6}, 0, -\frac{1}{30}, 0, \\frac{1}{42}, \ldots]$

	%	Sums of powers:
	%	\small
	%	\[ \sum_{i=1}^n n^m = \frac{1}{m+1} \sum_{k=0}^m \binom{m+1}{k} B_k (n+1)^{m+1-k} \]
	%	\normalsize
	%	Fórmula de Euler-Maclaurin para somas infinitas:
	%	\small
	%	\[ \sum_{i=m}^{\infty} f(i) = \int_m^\infty f(x) dx - \sum_{k=1}^\infty \frac{B_k}{k!}f^{(k-1)}(m) \]
	%	\[ \approx \int_{m}^\infty f(x)dx + \frac{f(m)}{2} - \frac{f'(m)}{12} + \frac{f'''(m)}{720} + O(f^{(5)}(m)) \]
	%	\normalsize

	\subsection{Stirling numbers of the first kind}
		Número de permutações em $n$ itens com $k$ ciclos.
		\begin{align*}
			&c(n,k) = c(n-1,k-1) + (n-1) c(n-1,k), c(0,0) = 1\\
			&\textstyle \sum_{k=0}^n c(n,k)x^k = x(x+1) \dots (x+n-1)
		\end{align*}
		$c(8,k) = 8, 0, 5040, 13068, 13132, 6769, 1960, 322, 28, 1$ 
		$c(n,2) = 0, 0, 1, 3, 11, 50, 274, 1764, 13068, 109584, \dots$

	\subsection{Eulerian numbers}
		Número de permutações $\pi \in S_n$ na qual exatamente $k$ elementos são maiores que os anteriores. $k$ $j$:s s.t. $\pi(j)>\pi(j+1)$, $k+1$ $j$:s s.t. $\pi(j)\geq j$, $k$ $j$:s s.t. $\pi(j)>j$.
		$$E(n,k) = (n-k)E(n-1,k-1) + (k+1)E(n-1,k)$$
		$$E(n,0) = E(n,n-1) = 1$$
		$$E(n,k) = \sum_{j=0}^k(-1)^j\binom{n+1}{j}(k+1-j)^n$$

	\subsection{Stirling numbers of the second kind}
		Partições de $n$ elementos distintos em exatamente $k$ grupos.
		$$S(n,k) = S(n-1,k-1) + k S(n-1,k)$$
		$$S(n,1) = S(n,n) = 1$$
		$$S(n,k) = \frac{1}{k!}\sum_{j=0}^k (-1)^{k-j}\binom{k}{j}j^n$$

	\subsection{Bell numbers}
		Número total de partições de $n$ elementos distintos. $B(n) =$
		$1, 1, 2, 5, 15, 52, 203, 877, 4140, 21147, \dots$. Para $p$ primo,
		\[ B(p^m+n)\equiv mB(n)+B(n+1) \pmod{p} \]

	\subsection{Labeled unrooted trees}
		\# em $n$ vertices: $n^{n-2}$\\
		\# em $k$ árvores existentes de tamanho $n_i$: $n_1n_2\cdots n_k n^{k-2}$ \\
		\# de grau $d_i$: $(n-2)! / ((d_1-1)! \cdots (d_n-1)!)$\\
		\# florestas com exatamente $k$ árvores enraizadas: $$\binom{n}{k} k \cdot n^{n-k-1}$$.
   
    
	\subsection{Catalan numbers}
		\[ C_n=\frac{1}{n+1}\binom{2n}{n}= \binom{2n}{n}-\binom{2n}{n+1} = \frac{(2n)!}{(n+1)!n!} \]
		\[ C_0=1,\ C_{n+1} = \frac{2(2n+1)}{n+2}C_n,\ C_{n+1}=\sum C_iC_{n-i} \]
		${C_n = 1, 1, 2, 5, 14, 42, 132, 429, 1430, 4862, 16796, 58786, \dots}$
		\begin{itemize}[noitemsep]
			\item sub-diagonal monotone paths in a $n\times n$ grid.
			\item strings with $n$ pairs of parenthesis, correctly nested.
			\item binary trees with with $n+1$ leaves (0 or 2 children) or $2n + 1$ elements.
			\item ordered trees with $n+1$ vertices.
			\item \# ways a convex polygon with $n+2$ sides can be cut into triangles by connecting vertices with straight lines.
			\item permutations of $[n]$ with no 3-term increasing subsequence.
		\end{itemize}
		\newline
    \subsection{Super Catalan numbers}
    The number of monotonic lattice paths of a $n$x$n$ grid that do not touch the diagonal.\\
    $$S(n) = \frac{3(2n-3)S(n-1)-(n-3)S(n-2)}{n}$$
    $$S(1) = S(2) = 1$$
    1, 1, 3, 11, 45, 197, 903, 4279, 20793, 103049, 518859\\
    
    \subsection{Motzkin numbers}
    Number of ways of drawing any number of nonintersecting chords among $n$ points on a circle. Number of lattice paths from (0, 0) to ($n$, 0) never going below the $x$-axis, using only steps NE, E, SE.\\
    
    $$M(n) = \frac{3(n-1)M(n-2)+(2n+1)M(n-1)}{n+2}$$\\
    $$M(0) = M(1) = 1$$\\
    1, 1, 2, 4, 9, 21, 51, 127, 323, 835, 2188, 5798, 15511, 41835, 113634
    \subsection{Narayana numbers}
    Number of lattice paths from (0,0) to ($2n$,0) never going below the $x$-axis, using only steps NE and SE, and with $k$ peaks.\\
    $$N(n,k) = \frac{1}{n} \binom{n}{k} \binom{n}{k-1}$$
    $$N(n,1) = N(n,n) = 1$$
    $$\sum_{k=1}^{n} N(n,k) = C_{n}$$
    1, 1, 1, 1, 3, 1, 1, 6, 6, 1, 1, 10, 20, 10, 1, 1, 15, 50
    \subsection{Schroder numbers}

    Number of lattice paths from (0, 0) to ($n$, $n$) using only steps
N,NE,E, never going above the diagonal. Number of lattice
paths from (0, 0) to ($2n$, 0) using only steps NE, SE and
double east EE, never going below the x-axis. Twice the
Super Catalan number, except for the first term.\\
1, 2, 6, 22, 90, 394, 1806, 8558, 41586, 206098\\

    \subsection{Triangles}
    $$\text{Given rods of length 1, ..., $n$,}$$\\
    
    $$T(n) = \frac{1}{24}  \left\{
        \begin{array}{ll}
            n(n - 2)(2n - 5) & \text{$n$ even}\\
            (n - 1)(n - 3)(2n - 1) & \text{$n$ odd}\\
        \end{array}
    \right.
    }$$\\
    is the number of distinct triangles (positive are) that can be constructed, i.e., the # of 3-subsets of $[n]$ s.t. $x \leq y \leq z$ and $z \neq x + y.$
        
    \subsection{Gambler's Ruin}
        Em um jogo no qual ganhamos cada aposta com probabilidade~$p$ e perdemos com probabilidade~$q \coloneqq 1 - p$, paramos quando ganhamos~$B$ ou perdemos~$A$. Então~$\mathit{Prob}(\textnormal{ganhar B}) = \frac{1 - (p/q)^B}{1 - (p/q)^{A+B}}$.\newline
    
    \section{Game Theory}
    A game can be reduced to Nim if it is a finite impartial game.
	Nim and its variants include:
	\subsection{Nim}
		Let $X = \bigoplus_{i=1}^n x_i$, then $(x_i)_{i=1}^n$ is a winning position iff $X\neq 0$. Find a move by picking $k$ such that $x_k > x_k \oplus X$.\newline
		
    \subsection{Mis\`{e}re Nim} 
        Regular Nim, except that the last player to move \textit{loses}. Play regular Nim until there is only one pile of size larger than $1$, reduce it to $0$ or $1$ such that there is an odd number of piles. The second player wins $(a_1, \dots, a_n)$ if 1) there is a pile $a_i > 1$ and $\oplus_{i=1}^{n} a_i = 0$ or 2) all $a_i \leq 1$ and $\oplus_{i=1}^{n} a_i = 1$.\newline
    \subsection{Staircase Nim}
    Stones are moved down a staircase and only removed from the last pile. $(x_i)_{i=1}^n$ is an $L$-position if $(x_{2i-1})_{i=1}^{n/2}$ is (i.e. only look at odd-numbered piles).\newline
    \subsection{Moore's Nim$_k$}
    The player may remove from at most $k$ piles (Nim $=$ Nim$_1$). Expand the piles in base $2$, do a carry-less addition in base $k+1$ (i.e. the number of ones in each column should be divisible by $k+1$).\newline
    \subsection{Dim$^+$}
    The number of removed stones must be a divisor of the pile size. The Sprague-Grundy function is $k+1$ where $2^k$ is the largest power of $2$ dividing the pile size.\newline
    \subsection{Aliquot Game}
    Same as above, except the divisor should be proper (hence $1$ is also a terminal state, but watch out for size $0$ piles). Now the Sprague-Grundy function is just $k$.\newline
    \subsection{Nim (at most half)}
    Write $n+1 = 2^my$ with $m$ maximal, then the Sprague-Grundy function of $n$ is $(y - 1) / 2$.\newline
    \subsection{Lasker's Nim}
    Players may alternatively split a pile into two new non-empty piles. $g(4k+1) = 4k+1$, $g(4k+2) = 4k+2$, $g(4k+3) = 4k+4$, $g(4k+4) = 4k+3$ ($k\geq 0$).\newline
    \subsection{Hackenbush on Trees}
    A tree with stalks $(x_i)_{i=1}^n$ may be replaced with a single stalk with length $\bigoplus_{i=1}^n x_i$.\newline
    \kactlimport{Nim.cpp}
    \kactlimport{Grundy.h}
	\kactlimport{Nim-Product.cpp}
	\kactlimport{Schreier-Sims.cpp}

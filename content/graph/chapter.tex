\chapter{Graph}

\section{Fundamentals}
    \kactlimport{bellman-ford.h}
    \kactlimport{floyd-warshall.h}
    \kactlimport{topo-sort.h}
    \kactlimport{dijkstra.h}
    %\kactlimport{SPFA.h}
    \kactlimport{euler-walk.h}

\section{Network flow}
	\kactlimport{push-relabel.h}
	\kactlimport{dinitz.h}
	%\kactlimport{HLPP.h}
	%\kactlimport{MinCut.h}
	\kactlimport{min-cost-max-flow.h}
	%\kactlimport{StoerWagner.h}
  
\section{Matching}
	\kactlimport{hopcroft-karp.h}
	\kactlimport{bipartite-matching.h}
        \kactlimport{weighted-matching.h}
	\kactlimport{general-matching-dfs.h}
	\kactlimport{general-matching.h}
	\kactlimport{max-independent-set.h}
	\kactlimport{min-vertex-cover.h}
	\kactlimport{min-edge-cover.h}
	\kactlimport{min-path-cover.h}

\section{DFS algorithms}
	\kactlimport{dfs-tree.h}
	\kactlimport{centroid-decomposition.h}
	\kactlimport{tarjan.h}
	\kactlimport{kosaraju.h}
	\kactlimport{bcc.h}
	\kactlimport{2sat.h}

\section{Heuristics}
	\kactlimport{maximal-cliques.h}
	\kactlimport{maximum-clique.h}
	\kactlimport{chromatic-number.h}
	\kactlimport{cycle-counting.cpp}
	\kactlimport{edge-coloring.h}

\section{Trees}
    %\kactlimport{Tree.h}
    \kactlimport{lca-binary-lifting.h}
    \kactlimport{lca-euler-tour.h}
    \kactlimport{compress-tree.h}
    \kactlimport{heavylight.h}
    \kactlimport{tree-isomorphism.h}
    %\kactlimport{LineTree.h}

    \subsection{Sqrt Decomposition}
		HLD generally suffices. If not, here are some common strategies:
		\begin{itemize}
			\item Rebuild the tree after every $\sqrt N$ queries. 
			\item Consider vertices with $>$ or $<\sqrt N$ degree separately. 
			\item For subtree updates, note that there are $O(\sqrt N)$ distinct sizes among child subtrees of any vertex.
		\end{itemize}

		\textbf{Block Tree:} Use a DFS to split edges into contiguous groups of size $\sqrt N$ to $2\sqrt N.$

		\textbf{Mo's Algorithm for Tree Paths:} Maintain an array of vertices where each one appears twice, once when a DFS enters the vertex (\texttt{st}) and one when the DFS exists (\texttt{en}). For a tree path $u\leftrightarrow v$ such that \texttt{st[u]<st[v]},

		\begin{itemize}
		\item If $u$ is an ancestor of $v,$ query \texttt{[st[u],st[v]]}.
		\item Otherwise, query $\texttt{[en[u],st[v]]}$ and consider $lca(u,v)$ separately.
		\end{itemize}
    
\section{Functional Graphs}
    \kactlimport{functional-graph.h}
    \kactlimport{functional-digraph.h}
\section{Other}
    %\kactlimport{MatrixTreeMST.h}
    %\kactlimport{ManhattanMST.h}
    %\kactlimport{Pruefer.cpp}    
    % \kactlimport{erdos-gallai.h}
    \kactlimport{directed-mst.h}

\section{Theorems}

\subsection{Landau}
There are a tournament with outdegree~$d_1 \leq d_2 \leq \ldots \leq d_n$ iff:
\begin{itemize}
\item $d_1 + d_2 + \ldots + d_n = {n \choose 2}$\newline
\item $d_1 + d_2 + \ldots + d_k \geq {k \choose 2} \quad \forall 1 \leq k \leq n.$
\end{itemize}
In order to build, lets make~1 point to~$2, 3, \ldots, d_1 + 1$ and we follow recursively

\

\subsection{Euler's theorem}
Let~$V$,~$A$ and~$F$ be the number of vertices, edges and faces of connected planar graph, $V - A + F = 2$


\

\subsection{Eulerian Cycles}
The number of Eulerian cycles in a \emph{directed} graph $G$ is:
\begin{equation*}
	t_w(G) \prod_{v \in G} (\deg v - 1)!,
\end{equation*}
where $t_w(G)$ is the number of arborescences (``directed spanning'' tree) rooted at $w$: $t_w(G) = \det\left( q_{ij} \right)_{i,j \neq w}$, with $q_{ij} = [i=j] \mathrm{indeg}(i) - \# \set{(i,j) \in E}$

\

\subsection{Dilworth's theorem}
For any partially ordered set, the sizes of the max antichain and of the min chain decomposition are equal. Equivalent to Konig's theorem on the bipartite graph $(U,V,E)$ where $U=V=S$ and $(u,v)$ is an edge when $u<v$. Those vertices outside the min vertex cover in both $U$ and $V$ form a max antichain

\

\subsection{König-Egervary theorem}
For Bipartite Graphs, the number of edges in the maximum matching is greater than or equal the number of vertices in the minimum cover


\subsubsection{Maximum Weight Closure}
Given a vertex-weighted directed graph $G$. Turn the graph into a flow
network, adding weight $\infty$ to each edge. Add vertices $S,T$. For
each vertex $v$ of weight $w$, add edge $(S,v,w)$ if $w\geq 0$, or edge
$(v,T,-w)$ if $w<0$. Sum of positive weights minus minimum $S-T$ cut is
the answer. Vertices reachable from $S$ are in the closure. The
maximum-weight closure is the same as the complement of the
minimum-weight closure on the graph with edges reversed.

\subsection{Maximum Weighted Independent Set in a Bipartite Graph}
This is the same as the minimum weighted vertex cover. Solve this by
constructing a flow network with edges $(S,u,w(u))$ for $u\in L$,
$(v,T,w(v))$ for $v\in R$ and $(u,v,\infty)$ for $(u,v)\in E$. The
minimum $S,T$-cut is the answer. Vertices adjacent to a cut edge are
in the vertex cover.

\subsection{Tutte-Berge formula}
The theorem states that the size of a maximum matching of a graph $G=(V,E)$ equals ${\frac {1}{2}}\min_{U\subseteq V}\left(|U|- \texttt{odd}(G-U)+|V|\right)\,,$ where \texttt{odd}(H) counts how many of the connected components of the graph $H$ have an odd number of vertices.

\subsection{Tutte's theorem}
A graph $G = (V, A)$ has a perfect matching iff for all subset $U$ of $V$, the induced subgraph by $V \setminus U$ has at most $|U|$ connected components with odd number of vertices.

%\subsection{Erdős–Gallai theorem}
%% Source: https://en.wikipedia.org/wiki/Erd%C5%91s%E2%80%93Gallai-theorem
%% Test: stress-tests/graph/matrix-tree.cpp
%A simple graph with node degrees $d-1 \ge \dots \ge d-n$ exists iff $d-1 + \dots + d-n$ is even and for every $k = 1\dots n$,
%\[ \sum -{i=1}^{k}d-{i}\leq k(k-1)+\sum -{i=k+1}^{n}\min(d-{i},k). \]

\subsection{Number of Spanning Trees}
		% I.e. matrix-tree theorem.
		% Source: https://en.wikipedia.org/wiki/Kirchhoff%27s-theorem
		% Test: stress-tests/graph/matrix-tree.cpp
		Define Laplacian Matrix as $L = D - A$, $D$ being a Diagonal Matrix with $D_{i,i} = deg(i)$ and $A$ an Adjacency Matrix.
		Create an $N\times N$ Laplacian matrix \texttt{mat}, and for each edge $a \rightarrow b \in G$, do
		\texttt{mat[a][b]--, mat[b][b]++} (and \texttt{mat[b][a]--, mat[a][a]++} if $G$ is undirected).
		Remove the $i$th row and column and take the determinant; this yields the number of directed spanning trees rooted at $i$
		(if $G$ is undirected, remove any row/column).

\subsection{Tutte Matrix}
	\begin{itemize}
	\item A graph has a perfect matching iff the $Tutte$ matrix has a non-zero determinant.

	\item The rank of the $Tutte$ matrix is equal to twice the size of the maximum matching. The maximum cost matching can be found by polynomial interpolation.
	\end{itemize}

\subsection{Menger's theorem}
\item Vertices:
A graph is k-connected iff all pairwise vertices are connected to at least 
$k$ internally disjoint paths.
\item Edges:
A graph is called $k$-edge-connected if the removal of at least $k$ edges of the graph keeps it connected. A graph is $k$-edge-connected iff for all pairwise vertices $u$ and $v$, exist $k$ paths which link $u$ to $v$ without sharing an edge.

% \subsection{Matroid Intersection theorem}
% Let~$M-1 = (E, I-1)$ e~$M-2 = (E, I-2)$ be matroids. Then
% $ \max\limits-{S \in I-1 \cap I-2}{|S|} = \min\limits-{U \subseteq E}{r-1(U) + r-2(E \setminus U)}.$



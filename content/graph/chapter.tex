\chapter{Graph}

\section{Fundamentals}
    \kactlimport{bellman-ford.h}
    \kactlimport{floyd-warshall.h}
    \kactlimport{dijkstra.h}
    \kactlimport{euler-walk.h}

\section{Network flow}
	\kactlimport{push-relabel.h}
	\kactlimport{dinitz.h}
	%\kactlimport{hlpp.h}
	\kactlimport{min-cost-max-flow.h}
  
\section{Matching}
	\kactlimport{hopcroft-karp.h}
	\kactlimport{bipartite-matching.h}
    \kactlimport{weighted-matching.h}
	% \kactlimport{general-matching-dfs.h}
	\kactlimport{general-matching.h}
	\kactlimport{max-independent-set.h}
	\kactlimport{min-vertex-cover.h}
	\kactlimport{min-edge-cover.h}
	\kactlimport{min-path-cover.h}

\section{DFS algorithms}
	% \kactlimport{dfs-tree.h}
	\kactlimport{tarjan.h}
	\kactlimport{2sat.h}
	\kactlimport{kosaraju.h}
	\kactlimport{bcc.h}
	
	
	
	
	

\section{Heuristics}
	\kactlimport{maximal-cliques.h}
	\kactlimport{maximum-clique.h}
	\kactlimport{chromatic-number.h}
	\kactlimport{cycle-counting.h}
	\kactlimport{edge-coloring.h}

\section{Trees}
    \kactlimport{lca-binary-lifting.h}
    \kactlimport{lca-euler-tour.h}
    \kactlimport{heavylight.h}
	\kactlimport{centroid-decomposition.h}
    \kactlimport{tree-isomorphism.h}
    \subsection{Sqrt Decomposition}
		\vspace{-0.2em}
		HLD generally suffices. If not, here are some common strategies:
		\begin{enumerate}
			\itemsep-0.8em
			\item Rebuild the tree after every $\sqrt N$ queries. 
			\item Consider vertices with $>$ or $<\sqrt N$ degree separately. 
			\item For subtree updates, note that there are $O(\sqrt N)$ distinct sizes among child subtrees of any vertex.
		\end{enumerate}
		\textbf{Block Tree:} Use a DFS to split edges into contiguous groups of size $\sqrt N$ to $2\sqrt N.$
		\textbf{Mo's Algorithm for Tree Paths:} Maintain an array of vertices where each one appears twice, once when a DFS enters the vertex (\texttt{st}) and one when the DFS exists (\texttt{en}). For a tree path $u\leftrightarrow v$ such that \texttt{st[u]<st[v]},
		\begin{enumerate}
			\itemsep-0.8em
			\item If $u$ is an ancestor of $v,$ query \texttt{[st[u],st[v]]}.
			\item Otherwise, query $\texttt{[en[u],st[v]]}$ and consider $lca(u,v)$ separately.
		\end{enumerate}
    
% \section{Functional Graphs}
%     \kactlimport{functional-graph.h}
%     \kactlimport{functional-digraph.h}
\section{Other}
	\kactlimport{manhattan-mst.h}
    %\kactlimport{Pruefer.cpp}    
    % \kactlimport{erdos-gallai.h}
    \kactlimport{directed-mst.h}


\section{Theorems}
\subsection{Euler's theorem}
Let $V$, $A$ and $F$ be the number of vertices, edges and faces of connected planar graph, $V - A + F = 2$.\\

\subsection{Konig's theorem}
In any bipartite graph the following holds: Maximum matching and minimum vertex cover have the same cardinality.
Minimum edge cover, minimum path cover and maximum independent set have the same cardinality $N - |M|$.\\

\subsection{Eulerian Cycles}
The number of Eulerian cycles in a \emph{directed} graph $G$ is: $t_w(G) \prod_{v \in G} (\deg v - 1)!$,
where $t_w(G)$ is the number of arborescences (``directed spanning'' tree) rooted at $w$
(Check Number of Spanning Trees)\\

% \subsection{Dilworth's theorem}
% For any partially ordered set, the sizes of the max antichain and of the min chain decomposition are equal. Equivalent to Konig's theorem on the bipartite graph $(U,V,E)$ where $U=V=S$ and $(u,v)$ is an edge when $u<v$. Those vertices outside the min vertex cover in both $U$ and $V$ form a max antichain

\subsection{Construct minimum vertex cover from maximum matching on bipartite graph}
\vspace{-0.2em}
\begin{enumerate}
	\itemsep-0.8em
	\item Redirect every edge: $y \rightarrow x$ if $(x, y) \in M$, $x \rightarrow y$ otherwise.
	\item DFS from unmatched vertices in $X$.
	\item $x \in X$ is chosen iff $x$ is unvisited.
	\item $y \in Y$ is chosen iff $y$ is visited.
\end{enumerate}

\subsection{Minimum weight edge cover}
\vspace{-0.2em}
    \begin{enumerate}
	  \itemsep-0.8em
      \item For each $v \in V$ create a copy $v^\prime$, and connect $u^\prime \to v^\prime$ with weight $w(u, v)$.
      \item Connect $v \to v^\prime$ with weight $2\mu(v)$, where $\mu(v)$ is the cost of the cheapest edge incident to $v$.
      \item Find the minimum weight perfect matching on $G^\prime$.
    \end{enumerate}

\subsection{Maximum/Minimum flow with lower bound / Circulation problem}
\vspace{-0.2em}
\begin{enumerate}
	\itemsep-0.8em
	\item Construct super source $S$ and sink $T$.
	\item For each edge $(x, y, l, u)$, connect $x \rightarrow y$ with capacity $u - l$.
	\item For each vertex $v$, denote by $in(v)$ the difference between the sum of incoming lower bounds and the sum of outgoing lower bounds.
	\item If $in(v) > 0$, connect $S \rightarrow v$ with capacity $in(v)$, otherwise, connect $v \rightarrow T$ with capacity $-in(v)$.
	\begin{itemize}
		\itemsep-0.3em
		\item To maximize, connect $t \rightarrow s$ with capacity $\infty$ (skip this in circulation problem), and let $f$ be the maximum flow from $S$ to $T$. If $f \neq \sum_{v \in V, in(v) > 0}{in(v)}$, there's no solution. Otherwise, the maximum flow from $s$ to $t$ is the answer.
		\item To minimize, let $f$ be the maximum flow from $S$ to $T$. Connect $t \rightarrow s$ with capacity $\infty$ and let the flow from $S$ to $T$ be $f^\prime$. If $f + f^\prime \neq \sum_{v \in V, in(v) > 0}{in(v)}$, there's no solution. Otherwise, $f^\prime$ is the answer.
	\end{itemize}
	\item The solution of each edge $e$ is $l_e + f_e$, where $f_e$ corresponds to the flow of edge $e$ on the graph.
\end{enumerate}

\subsection{Minimum cost cyclic flow}
\vspace{-0.2em}
\begin{enumerate}
	\itemsep-0.8em
	\item Consruct super source $S$ and sink $T$
	\item For each edge $(x, y, c)$, connect $x \rightarrow y$ with $(cost, cap) = (c, 1)$ if $c > 0$, otherwise connect $y \rightarrow x$ with $(cost, cap) = (-c, 1)$
	\item For each edge with $c < 0$, sum these cost as $K$, then increase $d(y)$ by 1, decrease $d(x)$ by 1
	\item For each vertex $v$ with $d(v) > 0$, connect $S \rightarrow v$ with $(cost, cap) = (0, d(v))$
	\item For each vertex $v$ with $d(v) < 0$, connect $v \rightarrow T$ with $(cost, cap) = (0, -d(v))$
	\item Flow from $S$ to $T$, the answer is the cost of the flow $C + K$
\end{enumerate}

\

\subsection{Maximum density induced subgraph}
\vspace{-0.2em}
\begin{enumerate}
	\itemsep-0.8em
	\item Binary search on answer, suppose we're checking answer $T$
	\item Construct a max flow model, let $K$ be the sum of all weights
	\item Connect source $s \rightarrow v$, $v \in G$ with capacity $K$
	\item For each edge $(u, v, w)$ in $G$, connect $u \rightarrow v$ and $v \rightarrow u$ with capacity $w$
	\item For $v \in G$, connect it with sink $v \rightarrow t$ with capacity $K + 2T - (\sum_{e \in E(v)}{w(e)}) - 2w(v)$
	\item $T$ is a valid answer if the maximum flow $f < K \lvert V \rvert$
\end{enumerate}

\subsection{Project selection problem}
\vspace{-0.2em}
    \begin{enumerate}
		\itemsep-0.8em
      \item If $p_v > 0$, create edge $(s, v)$ with capacity $p_v$; otherwise, create edge $(v, t)$ with capacity $-p_v$.
      \item Create edge $(u, v)$ with capacity $w$ with $w$ being the cost of choosing $u$ without choosing $v$.
      \item The mincut is equivalent to the maximum profit of a subset of projects.
    \end{enumerate}

\subsection{0/1 quadratic programming}
\vspace{-0.2em}
    \[ \sum_x{c_xx} + \sum_y{c_y\bar{y}} + \sum_{xy}c_{xy}x\bar{y} + \sum_{xyx^\prime y^\prime}c_{xyx^\prime y^\prime}(x\bar{y} + x^\prime\bar{y^\prime}) \]
    can be minimized by the mincut of the following graph:
    \begin{enumerate}
      \itemsep-0.8em
      \item Create edge $(x, t)$ with capacity $c_x$ and create edge $(s, y)$ with capacity $c_y$.
      \item Create edge $(x, y)$ with capacity $c_{xy}$.
      \item Create edge $(x, y)$ and edge $(x^\prime, y^\prime)$ with capacity $c_{xyx^\prime y^\prime}$.
    \end{enumerate}

% \subsubsection{Maximum Weight Closure}
% Given a vertex-weighted directed graph $G$. Turn the graph into a flow
% network, adding weight $\infty$ to each edge. Add vertices $S,T$. For
% each vertex $v$ of weight $w$, add edge $(S,v,w)$ if $w\geq 0$, or edge
% $(v,T,-w)$ if $w<0$. Sum of positive weights minus minimum $S-T$ cut is
% the answer. Vertices reachable from $S$ are in the closure. The
% maximum-weight closure is the same as the complement of the
% minimum-weight closure on the graph with edges reversed.

% \subsection{Maximum Weighted Independent Set in a Bipartite Graph}
% This is the same as the minimum weighted vertex cover. Solve this by
% constructing a flow network with edges $\smash{(S,u,w(u))}$ for $u\in L$,
% $(v,T,w(v))$ for $v\in R$ and $(u,v,\infty)$ for $(u,v)\in E$. The
% minimum $S,T$-cut is the answer. Vertices adjacent to a cut edge are
% in the vertex cover.

%\subsection{Tutte-Berge formula}
%The theorem states that the size of a maximum matching of a graph $G=(V,E)$ equals ${\frac{1}{2}}\min_{U\subseteq V}\left(|U|- \texttt{odd}(G-U)+|V|\right)\,,$ where \texttt{odd}(H) counts how many of the connected components of the graph $H$ have an odd number of vertices.

% \subsection{Tutte's theorem}
%A graph $G = (V, A)$ has a perfect matching iff for all subset $U$ of $V$, the induced subgraph by $V \setminus U$ has at most $|U|$ connected components with odd number of vertices.

%\subsection{Erdős–Gallai theorem}
%% Source: https://en.wikipedia.org/wiki/Erd%C5%91s%E2%80%93Gallai-theorem
%% Test: stress-tests/graph/matrix-tree.cpp
%A simple graph with node degrees $d-1 \ge \dots \ge d-n$ exists iff $d-1 + \dots + d-n$ is even and for every $k = 1\dots n$,
%\[ \sum -{i=1}^{k}d-{i}\leq k(k-1)+\sum -{i=k+1}^{n}\min(d-{i},k). \]

\subsection{Number of Spanning Trees}
		% I.e. matrix-tree theorem.
		% Source: https://en.wikipedia.org/wiki/Kirchhoff%27s-theorem
		% Test: stress-tests/graph/matrix-tree.cpp
		Define Laplacian Matrix as $L = D - A$, $D$ being a Diagonal Matrix with $D_{i,i} = indeg(i)$ and $A$ an Adjacency Matrix.
		Create an $N\times N$ Laplacian matrix \texttt{mat}, and for each edge $a \rightarrow b \in G$, do
		\texttt{mat[a][b]--, mat[b][b]++} (and \texttt{mat[b][a]--, mat[a][a]++} if $G$ is undirected).
		Remove the $i$th row and column and take the determinant; this yields the number of directed spanning trees rooted at $i$
		(if $G$ is undirected, remove any row/column).

\subsection{Tutte Matrix}
	\begin{itemize}
	\item A graph has a perfect matching iff the $Tutte$ matrix has a non-zero determinant.
	\item The rank of the $Tutte$ matrix is equal to twice the size of the maximum matching. The maximum cost matching can be found by polynomial interpolation.
	\end{itemize}
% \subsection{Matroid Intersection theorem}
% Let~$M-1 = (E, I-1)$ e~$M-2 = (E, I-2)$ be matroids. Then
% $ \max\limits-{S \in I-1 \cap I-2}{|S|} = \min\limits-{U \subseteq E}{r-1(U) + r-2(E \setminus U)}.$



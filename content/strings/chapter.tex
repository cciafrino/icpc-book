\chapter{Strings}

\kactlimport{kmp.h}
\kactlimport{duval.h}
\kactlimport{z-algorithm.h}
\kactlimport{manacher.h}
\kactlimport{min-rotation.h}
\kactlimport{xor-trie.h}
\kactlimport{hashing.h}
\kactlimport{modnum-double-hashing.h}
\kactlimport{aho-corasick.h}
\kactlimport{suffix-array.h}
\kactlimport{suffix-tree.h}
\kactlimport{suffix-automaton.h}

\section{Suffix Automaton}
\subsection{Number of different substrings}
        Is the number of paths in the automaton starting at the root.
        $$d(v) = 1 + \sum_{v \rightarrow w} d(w)$$

\

\subsection{Total lenght of different substrings}
        Is the sum of children answers and paths starting 
        at each children.
        
        $$ans(v) = \sum_{v \rightarrow w} d(w) + ans(w)$$

\


\subsection{Lexicographically $K$-th substring}
        Is the $K$-th lexicographically path, so you can search using the number of paths from each state

\

\subsection{Smallest cyclic shift}
        Construct for string $S + S$. Greedily search 
        the minimal character.

\


\subsection{Number of occurrences}
        For each state not created by cloning, initialize $cnt(v) = 1$. 
        Then, just do a dfs to calculate $cnt(v)$
        
        $$cnt(link(v)) += cnt(v)$$

\subsection{First occurence position}
        When we create a new state $cur$ do $first(pos) = len(cur) - 1$.
        When we clone $q$ as $clone$ do $first(clone) = first(q)$.
        Answer is $first(v) - size(P) + 1$, where $v$ is the state of string $P$

\subsection{All occurence positions}
        From $first(v)$ do a dfs using suffix link, from $link(u)$ go to $u$.
